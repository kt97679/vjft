1. Пользователь нажимает клавишу

Когда пользователь нажимает клавишу, SDL генерирует событие клавиши, которое мы обрабатываем в основном игровом цикле в классе App.
2. Событие клавиши передается в EventManager

Внутри метода App::loop:

    Мы используем SDL_PollEvent для получения события из очереди событий SDL.
    Если тип события — SDL_KEYDOWN, мы определяем, какая клавиша была нажата (например, W, A, S, D).
    В зависимости от нажатой клавиши, мы создаем объект KeyEvent с соответствующим значением KeyCode (например, KeyEvent::W).
    Затем мы передаем это событие в EventManager с помощью метода sendEvent.

3. EventManager уведомляет подписчиков

Внутри метода EventManager::sendEvent:

    EventManager хранит список всех подписчиков (EventListener), которые зарегистрировались для получения событий.
    sendEvent проходит по списку слушателей и вызывает метод onEvent для каждого слушателя, передавая событие KeyEvent.

4. Player получает событие

Внутри метода Player::onEvent:

    Player реализует интерфейс EventListener, поэтому он получает событие KeyEvent, когда EventManager вызывает onEvent.
    Player использует динамическое приведение типов (dynamic_cast), чтобы проверить, является ли событие KeyEvent.
    Если событие является KeyEvent, Player вызывает метод handleKeyEvent.

5. Player обрабатывает событие и обновляет StickFigure

Внутри метода Player::handleKeyEvent:

    Player проверяет значение KeyCode внутри события KeyEvent.
    В зависимости от значения KeyCode (например, KeyEvent::W для движения вверх), Player вызывает соответствующий метод перемещения на StickFigure (например, stickFigure.moveUp()).

6. StickFigure обновляет свое состояние

Внутри методов StickFigure (например, moveUp, moveDown и т.д.):

    StickFigure обновляет свое внутреннее состояние, например, меняет свою позицию на экране.
    Эти изменения будут видны в следующем обновлении и отрисовке.

7. Обновление и отрисовка

Внутри метода App::loop:

    После обработки всех событий, App вызывает метод update у StickFigure, который обновляет его позицию и анимацию в зависимости от текущего состояния.
    Затем App очищает экран и вызывает метод draw у StickFigure, чтобы отрисовать его на экране в новом положении.

Примерный порядок действий

    Пользователь нажимает клавишу "W".
    SDL генерирует событие SDL_KEYDOWN.
    В методе App::loop, SDL_PollEvent обнаруживает событие SDL_KEYDOWN.
    App создает объект KeyEvent с KeyCode равным KeyEvent::W.
    App передает событие в EventManager через метод sendEvent.
    EventManager уведомляет всех подписчиков, вызывая метод onEvent у Player.
    Player получает событие и вызывает метод handleKeyEvent.
    Player обрабатывает событие и вызывает метод moveUp у StickFigure.
    StickFigure обновляет свою позицию для движения вверх.
    В следующем цикле обновления App вызывает метод update у StickFigure.
    App очищает экран и вызывает метод draw у StickFigure.
    StickFigure отрисовывается в новом положении на экране.
